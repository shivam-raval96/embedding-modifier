{"ast":null,"code":"/**\n * @param  {Array<THREE.Material>|THREE.Material} material\n * @return {Array<THREE.Material>}\n */\nfunction ensureMaterialArray(material) {\n  if (!material) {\n    return [];\n  } else if (Array.isArray(material)) {\n    return material;\n  } else if (material.materials) {\n    return material.materials;\n  } else {\n    return [material];\n  }\n}\n\n/**\n * @param  {THREE.Object3D} mesh\n * @param  {Array<string>} materialNames\n * @param  {THREE.Texture} envMap\n * @param  {number} reflectivity  [description]\n */\nfunction applyEnvMap(mesh, materialNames, envMap, reflectivity) {\n  if (!mesh) return;\n  materialNames = materialNames || [];\n  mesh.traverse(function (node) {\n    if (!node.isMesh) return;\n    var meshMaterials = ensureMaterialArray(node.material);\n    meshMaterials.forEach(function (material) {\n      if (material && !('envMap' in material)) return;\n      if (materialNames.length && materialNames.indexOf(material.name) === -1) return;\n      material.envMap = envMap;\n      material.reflectivity = reflectivity;\n      material.needsUpdate = true;\n    });\n  });\n}\n\n/**\n * Specifies an envMap on an entity, without replacing any existing material\n * properties.\n */\nmodule.exports = AFRAME.registerComponent('cube-env-map', {\n  multiple: true,\n  schema: {\n    path: {\n      default: ''\n    },\n    extension: {\n      default: 'jpg',\n      oneOf: ['jpg', 'png']\n    },\n    format: {\n      default: 'RGBFormat',\n      oneOf: ['RGBFormat', 'RGBAFormat']\n    },\n    enableBackground: {\n      default: false\n    },\n    reflectivity: {\n      default: 1,\n      min: 0,\n      max: 1\n    },\n    materials: {\n      default: []\n    }\n  },\n  init: function init() {\n    var _this = this;\n    var data = this.data;\n    this.texture = new THREE.CubeTextureLoader().load([data.path + 'posx.' + data.extension, data.path + 'negx.' + data.extension, data.path + 'posy.' + data.extension, data.path + 'negy.' + data.extension, data.path + 'posz.' + data.extension, data.path + 'negz.' + data.extension]);\n    this.texture.format = THREE[data.format];\n    this.object3dsetHandler = function () {\n      var mesh = _this.el.getObject3D('mesh');\n      var data = _this.data;\n      applyEnvMap(mesh, data.materials, _this.texture, data.reflectivity);\n    };\n    this.el.addEventListener('object3dset', this.object3dsetHandler);\n  },\n  update: function update(oldData) {\n    var data = this.data;\n    var mesh = this.el.getObject3D('mesh');\n    var addedMaterialNames = [];\n    var removedMaterialNames = [];\n    if (data.materials.length) {\n      if (oldData.materials) {\n        addedMaterialNames = data.materials.filter(function (name) {\n          return !oldData.materials.includes(name);\n        });\n        removedMaterialNames = oldData.materials.filter(function (name) {\n          return !data.materials.includes(name);\n        });\n      } else {\n        addedMaterialNames = data.materials;\n      }\n    }\n    if (addedMaterialNames.length) {\n      applyEnvMap(mesh, addedMaterialNames, this.texture, data.reflectivity);\n    }\n    if (removedMaterialNames.length) {\n      applyEnvMap(mesh, removedMaterialNames, null, 1);\n    }\n    if (oldData.materials && data.reflectivity !== oldData.reflectivity) {\n      var maintainedMaterialNames = data.materials.filter(function (name) {\n        return oldData.materials.includes(name);\n      });\n      if (maintainedMaterialNames.length) {\n        applyEnvMap(mesh, maintainedMaterialNames, this.texture, data.reflectivity);\n      }\n    }\n    if (this.data.enableBackground && !oldData.enableBackground) {\n      this.setBackground(this.texture);\n    } else if (!this.data.enableBackground && oldData.enableBackground) {\n      this.setBackground(null);\n    }\n  },\n  remove: function remove() {\n    this.el.removeEventListener('object3dset', this.object3dsetHandler);\n    var mesh = this.el.getObject3D('mesh');\n    var data = this.data;\n    applyEnvMap(mesh, data.materials, null, 1);\n    if (data.enableBackground) this.setBackground(null);\n  },\n  setBackground: function setBackground(texture) {\n    this.el.sceneEl.object3D.background = texture;\n  }\n});","map":{"version":3,"names":["ensureMaterialArray","material","Array","isArray","materials","applyEnvMap","mesh","materialNames","envMap","reflectivity","traverse","node","isMesh","meshMaterials","forEach","length","indexOf","name","needsUpdate","module","exports","AFRAME","registerComponent","multiple","schema","path","default","extension","oneOf","format","enableBackground","min","max","init","_this","data","texture","THREE","CubeTextureLoader","load","object3dsetHandler","el","getObject3D","addEventListener","update","oldData","addedMaterialNames","removedMaterialNames","filter","includes","maintainedMaterialNames","setBackground","remove","removeEventListener","sceneEl","object3D","background"],"sources":["/Users/Shivam/Library/CloudStorage/GoogleDrive-sraval@g.harvard.edu/My Drive/Github/embedding-modifier/app/node_modules/aframe-extras/src/misc/cube-env-map.js"],"sourcesContent":["/**\n * @param  {Array<THREE.Material>|THREE.Material} material\n * @return {Array<THREE.Material>}\n */\nfunction ensureMaterialArray (material) {\n  if (!material) {\n    return [];\n  } else if (Array.isArray(material)) {\n    return material;\n  } else if (material.materials) {\n    return material.materials;\n  } else {\n    return [material];\n  }\n}\n\n/**\n * @param  {THREE.Object3D} mesh\n * @param  {Array<string>} materialNames\n * @param  {THREE.Texture} envMap\n * @param  {number} reflectivity  [description]\n */\nfunction applyEnvMap (mesh, materialNames, envMap, reflectivity) {\n  if (!mesh) return;\n\n  materialNames = materialNames || [];\n\n  mesh.traverse((node) => {\n\n    if (!node.isMesh) return;\n\n    const meshMaterials = ensureMaterialArray(node.material);\n\n    meshMaterials.forEach((material) => {\n\n      if (material && !('envMap' in material)) return;\n      if (materialNames.length && materialNames.indexOf(material.name) === -1) return;\n\n      material.envMap = envMap;\n      material.reflectivity = reflectivity;\n      material.needsUpdate = true;\n\n    });\n\n  });\n}\n\n/**\n * Specifies an envMap on an entity, without replacing any existing material\n * properties.\n */\nmodule.exports = AFRAME.registerComponent('cube-env-map', {\n  multiple: true,\n\n  schema: {\n    path: {default: ''},\n    extension: {default: 'jpg', oneOf: ['jpg', 'png']},\n    format: {default: 'RGBFormat', oneOf: ['RGBFormat', 'RGBAFormat']},\n    enableBackground: {default: false},\n    reflectivity: {default: 1, min: 0, max: 1},\n    materials: {default: []}\n  },\n\n  init: function () {\n    const data = this.data;\n\n    this.texture = new THREE.CubeTextureLoader().load([\n      data.path + 'posx.' + data.extension, data.path + 'negx.' + data.extension,\n      data.path + 'posy.' + data.extension, data.path + 'negy.' + data.extension,\n      data.path + 'posz.' + data.extension, data.path + 'negz.' + data.extension\n    ]);\n    this.texture.format = THREE[data.format];\n\n    this.object3dsetHandler = () => {\n      const mesh = this.el.getObject3D('mesh');\n      const data = this.data;\n      applyEnvMap(mesh, data.materials, this.texture, data.reflectivity);\n    };\n    this.el.addEventListener('object3dset', this.object3dsetHandler);\n  },\n\n  update: function (oldData) {\n    const data = this.data;\n    const mesh = this.el.getObject3D('mesh');\n\n    let addedMaterialNames = [];\n    let removedMaterialNames = [];\n\n    if (data.materials.length) {\n      if (oldData.materials) {\n        addedMaterialNames = data.materials.filter((name) => !oldData.materials.includes(name));\n        removedMaterialNames = oldData.materials.filter((name) => !data.materials.includes(name));\n      } else {\n        addedMaterialNames = data.materials;\n      }\n    }\n    if (addedMaterialNames.length) {\n      applyEnvMap(mesh, addedMaterialNames, this.texture, data.reflectivity);\n    }\n    if (removedMaterialNames.length) {\n      applyEnvMap(mesh, removedMaterialNames, null, 1);\n    }\n\n    if (oldData.materials && data.reflectivity !== oldData.reflectivity) {\n      const maintainedMaterialNames = data.materials\n        .filter((name) => oldData.materials.includes(name));\n      if (maintainedMaterialNames.length) {\n        applyEnvMap(mesh, maintainedMaterialNames, this.texture, data.reflectivity);\n      }\n    }\n\n    if (this.data.enableBackground && !oldData.enableBackground) {\n      this.setBackground(this.texture);\n    } else if (!this.data.enableBackground && oldData.enableBackground) {\n      this.setBackground(null);\n    }\n  },\n\n  remove: function () {\n    this.el.removeEventListener('object3dset', this.object3dsetHandler);\n    const mesh = this.el.getObject3D('mesh');\n    const data = this.data;\n\n    applyEnvMap(mesh, data.materials, null, 1);\n    if (data.enableBackground) this.setBackground(null);\n  },\n\n  setBackground: function (texture) {\n    this.el.sceneEl.object3D.background = texture;\n  }\n});\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}