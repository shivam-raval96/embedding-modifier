{"ast":null,"code":"var _jsxFileName = \"/Users/Shivam/Library/CloudStorage/GoogleDrive-sraval@g.harvard.edu/My Drive/Github/embedding-modifier/app/src/plotdata.js\",\n  _s = $RefreshSig$();\nimport React, { useRef, useEffect, useState } from 'react';\nimport * as d3 from 'd3';\nimport { PieChart } from 'react-minimal-pie-chart';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst r_small = 5;\nconst r_big = 15;\nconst colors2 = [\"#9edae5\", \"#17becf\", \"#dbdb8d\", \"#bcbd22\", \"#c7c7c7\", \"#7f7f7f\", \"#f7b6d2\", \"#e377c2\", \"#c49c94\", \"#8c564b\", \"#c5b0d5\", \"#9467bd\", \"#ff9896\", \"#d62728\", \"#98df8a\", \"#2ca02c\", \"#ffbb78\", \"#ff7f0e\", \"#aec7e8\", \"#1f77b4\"];\nconst colors = [\"#d62728\", \"#bcbd22\", \"#000000\", \"#17becf\", \"#FFD700\", \"#9467bd\", \"#808080\", \"#1f77b4\", \"#2ca02c\", \"#ff7f0e\", \"#7f7f7f\", \"#e377c2\"];\nfunction addAlpha(color, opacity) {\n  // coerce values so ti is between 0 and 1.\n  var _opacity = Math.round(Math.min(Math.max(opacity || 1, 0), 1) * 255);\n  return color.slice(0, 7) + _opacity.toString(16).toUpperCase();\n}\nconst getColumn = (arr, n) => arr.map(x => x[n]);\nfunction encodeArray(array) {\n  // Step 1: Identify unique strings\n  const uniqueStrings = new Set(array);\n\n  // Step 2: Map strings to numbers\n  const stringToNumberMap = {};\n  let number = 0;\n  uniqueStrings.forEach(str => {\n    stringToNumberMap[str] = number++;\n  });\n\n  // Step 3: Generate encoded array\n  return stringToNumberMap;\n}\nfunction getEncodedArray(array, stringToNumberMap) {\n  return array.map(str => stringToNumberMap[str]);\n}\nfunction getPieDistribution(data, labels) {\n  let distribution = {};\n  for (let i = 0; i < labels.length; i++) {\n    let label = labels[i];\n    let item = data[i];\n    if (!distribution[label]) {\n      distribution[label] = {};\n    }\n    if (!distribution[label][item]) {\n      distribution[label][item] = 0;\n    }\n    distribution[label][item]++;\n  }\n  return distribution;\n}\nconst Legend = ({\n  stringToNumberMap,\n  colors\n}) => {\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      padding: '10px',\n      border: '1px solid #ccc',\n      borderRadius: '5px',\n      backgroundColor: '#fff',\n      boxShadow: '0 2px 4px rgba(0,0,0,0.1)',\n      maxWidth: '200px',\n      fontFamily: 'Arial, sans-serif',\n      fontSize: '14px'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n      style: {\n        textAlign: 'center'\n      },\n      children: \"Legend\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 7\n    }, this), Object.keys(stringToNumberMap).map((label, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: 'flex',\n        alignItems: 'center',\n        marginBottom: '4px'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        style: {\n          display: 'inline-block',\n          width: '20px',\n          height: '20px',\n          borderRadius: '50%',\n          backgroundColor: colors[stringToNumberMap[label] % colors.length],\n          marginRight: '10px'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        children: label\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 11\n      }, this)]\n    }, index, true, {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 9\n    }, this))]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 72,\n    columnNumber: 5\n  }, this);\n};\n_c = Legend;\nfunction trackPointer(e, {\n  start,\n  move,\n  out,\n  end\n}) {\n  const tracker = {},\n    id = tracker.id = e.pointerId,\n    target = e.target;\n  tracker.point = d3.pointer(e, target);\n  target.setPointerCapture(id);\n  d3.select(target).on(`pointerup.${id} pointercancel.${id} lostpointercapture.${id}`, e => {\n    if (e.pointerId !== id) return;\n    tracker.sourceEvent = e;\n    d3.select(target).on(`.${id}`, null);\n    target.releasePointerCapture(id);\n    end && end(tracker);\n  }).on(`pointermove.${id}`, e => {\n    if (e.pointerId !== id) return;\n    tracker.sourceEvent = e;\n    tracker.prev = tracker.point;\n    tracker.point = d3.pointer(e, target);\n    move && move(tracker);\n  }).on(`pointerout.${id}`, e => {\n    if (e.pointerId !== id) return;\n    tracker.sourceEvent = e;\n    tracker.point = null;\n    out && out(tracker);\n  });\n  start && start(tracker);\n}\nfunction Scatterplot(props) {\n  _s();\n  var {\n    width,\n    height,\n    data,\n    labels,\n    colorCol,\n    jitter\n  } = props;\n  const margin = {\n    top: 100,\n    left: 120,\n    right: 80,\n    bottom: 100\n  };\n  const ref = useRef();\n  const [pieCharts, setPieCharts] = useState([]);\n  const defaultLasso = [[0, 0]];\n  const [searchQuery, setSearchQuery] = useState('this is a test');\n  const [stringToNumberMap, setStringToNumberMap] = useState({\n    '0': 'none'\n  });\n  useEffect(() => {\n    data.forEach((d, i) => {\n      d.id = i;\n    });\n    const svg = d3.select(ref.current);\n    function lasso() {\n      const dispatch = d3.dispatch(\"start\", \"lasso\", \"end\");\n      const lasso = function (selection) {\n        const node = selection.node();\n        const polygon = [];\n        selection.on(\"touchmove\", e => e.preventDefault()) // prevent scrolling\n        .on(\"pointerdown\", e => {\n          trackPointer(e, {\n            start: p => {\n              polygon.length = 0;\n              dispatch.call(\"start\", node, polygon);\n            },\n            move: p => {\n              polygon.push(p.point);\n              dispatch.call(\"lasso\", node, polygon);\n            },\n            end: p => {\n              dispatch.call(\"end\", node, polygon);\n            }\n          });\n        });\n      };\n      lasso.on = function (type, _) {\n        return _ ? (dispatch.on(...arguments), lasso) : dispatch.on(...arguments);\n      };\n      return lasso;\n    }\n\n    //svg.selectAll('*').remove()\n    svg.selectAll('text.label').remove();\n    svg.selectAll(\"path\").remove();\n    d3.select(\"#selectioncontent\").selectAll('*').remove();\n    const path = d3.geoPath();\n    const l = svg.append(\"path\").attr(\"class\", \"lasso\");\n    svg.append(\"defs\").append(\"style\").text(`\n    .selected {r: 2.5; fill: red}\n    .lasso { fill-rule: evenodd; fill-opacity: 0.1; stroke-width: 1.5; stroke: #000; z-index: 0;}\n  `);\n    function draw(polygon) {\n      //d3.select(\"#selectioncontent\").selectAll('*').remove()\n\n      // selectioncontent\n      // const selectioncontent = d3.select(\"#selectioncontent\").append(\"div\")\n      //var content = '<table>'\n\n      let table = document.getElementById(\"myTable\");\n      table.innerHTML = \"\";\n      l.datum({\n        type: \"LineString\",\n        coordinates: polygon\n      }).attr(\"d\", path).style('z-index', -10);\n      const selected = [];\n\n      // note: d3.polygonContains uses the even-odd rule\n      // which is reflected in the CSS for the lasso shape\n      circles.classed(\"selected\", polygon.length > 2 ? d => {\n        d3.polygonContains(polygon, [xScale(d[0]), yScale(d[1])]) && selected.push(d);\n      } //&& (content += \" <tr><td>\"+d[2] + \"</td></tr>\" )}\n      : false);\n      //content += '</table>'\n\n      /*for (const [key, idx] of Object.entries(stringToNumberMap)){\n          console.log(key,\"<font color=\\\"red\\\">\"+key+\"</font>\")\n          content = content.replaceAll(key,\"<font color=\\\"\"+colors[idx]+\"\\\">\"+key+\"</font>\")\n      }*/\n\n      var TableBackgroundNormalColor = \"#ffffff\";\n      var TableBackgroundMouseoverColor = \"#b8b6b6\";\n\n      // These two functions need no customization.\n      function ChangeBackgroundColor(row, id) {\n        row.style.backgroundColor = row.style.backgroundColor.replace(/[^,]+(?=\\))/, 0.8);\n        row.style.border = '1px solid black !important';\n        svg.selectAll('circle').transition(100).attr(\"r\", function (d) {\n          var dIsInSubset = d.id == id;\n          return dIsInSubset ? r_big : r_small;\n        });\n      }\n      function RestoreBackgroundColor(row) {\n        row.style.backgroundColor = row.style.backgroundColor.replace(/[^,]+(?=\\))/, 0.4);\n        //row.style.backgroundColor = TableBackgroundNormalColor; \n        svg.selectAll('circle').transition(100).attr(\"r\", r_small);\n      }\n      selected.forEach(d => {\n        let tr = document.createElement(\"tr\");\n        tr.innerHTML = `<td>${d[2]}</td>`;\n        tr.style.backgroundColor = addAlpha(colors[color_idx[d.id]], 0.4);\n\n        //tr.addEventListener('mouseover', () => console.log(d));\n        tr.addEventListener('mouseover', () => {\n          console.log(d);\n          ChangeBackgroundColor(tr, d.id);\n        });\n        tr.addEventListener('mouseout', () => {\n          console.log(d);\n          RestoreBackgroundColor(tr);\n        });\n        table.appendChild(tr);\n      });\n      svg.value = {\n        polygon,\n        selected\n      };\n\n      //selectioncontent.html(content)\n      //selectioncontent.addEventListener('mouseover', () => console.log(datum));\n    }\n\n    // Set scales for the scatterplot\n    const xScale = d3.scaleLinear().domain([d3.min(data, d => d[0]), d3.max(data, d => d[0])]).range([margin.left, width - margin.right]);\n    const yScale = d3.scaleLinear().domain([d3.min(data, d => d[1]), d3.max(data, d => d[1])]).range([height - margin.bottom, margin.top]);\n\n    // Tooltips\n    const tooltip = d3.select(\"body\").append(\"div\").attr(\"class\", \"tooltip\").style(\"opacity\", 0).style(\"background-color\", \"white\").style(\"border\", \"solid\").style(\"border-width\", \"2px\").style(\"border-radius\", \"5px\").style(\"padding\", \"5px\").style(\"margin-right\", \"50px\").style(\"position\", \"absolute\");\n    console.log(data);\n    // Bind data to circles and add tooltips\n    //console.log(labels)\n    // Compute the density contours.\n    const contours = d3.contourDensity().x(d => xScale(d[0])).y(d => yScale(d[1])).size([width, height]).bandwidth(40).thresholds(3)(data);\n\n    //console.log(contours)\n\n    // Append the contours.\n    /*var contourPaths = svg.selectAll('contours').attr(\"stroke-linejoin\", \"round\")\n        .attr(\"stroke\", 'black')\n        .data(contours)\n        .join(\"path\")\n        .style(\"opacity\", 0) \n        .attr(\"fill\", (d, i) => 'gray')\n        .attr(\"stroke-width\", (d, i) => i % 5 ? 0.25 : 1)\n        //.attr(\"stroke\", 'red')\n        .style(\"z-index\", -1)\n        .attr(\"d\", d3.geoPath());\n     contourPaths.transition().duration(2500).style(\"opacity\", (d, i) => i % 5 ? 0 : 0.2)*/\n\n    //SetcolorCol\n    if (colorCol != -1) {\n      var array = getColumn(data, colorCol);\n      setStringToNumberMap(encodeArray(array));\n    } else {\n      var array = getColumn(data, 3);\n      setStringToNumberMap(encodeArray(getColumn(data, 3)));\n    }\n    var color_idx = getEncodedArray(array, stringToNumberMap);\n    let result = getPieDistribution(getColumn(data, colorCol), getColumn(data, 3));\n    console.log(colorCol, stringToNumberMap);\n\n    // Bind data to circles\n    const circles = svg.selectAll('circle').data(data);\n\n    // Enter new circles\n    circles.enter().append('circle').attr('cx', d => xScale(d[0])).attr('cy', d => yScale(d[1])).attr('r', d => d[2].toLowerCase().includes(searchQuery.toLowerCase()) ? r_big : r_small).style(\"opacity\", 0.9).attr('fill', (d, i) => colors[color_idx[i] % 10]).attr('stroke', 'black') // Add this line for the boundary color\n    .attr('stroke-width', 0.5) // Add this line for the boundary width\n    .style(\"z-index\", 2).on(\"mouseover\", (event, d) => {\n      svg.selectAll('circle').transition().duration(100).style(\"opacity\", 0.9).attr('stroke-width', 0.5);\n      //.attr('r', r_small);\n      d3.select(event.currentTarget).transition().duration(100).style(\"opacity\", 1).attr('stroke-width', 4); // Add this line for the boundary width\n      //.attr('r', r_small);\n\n      let highlightedText = d[2];\n      if (searchQuery) {\n        const regex = new RegExp(`(${searchQuery})`, 'gi');\n        highlightedText = highlightedText.replace(regex, \"<span style='background-color: yellow;'>$1</span>\");\n      }\n      tooltip.transition().duration(100).style(\"opacity\", .9);\n      tooltip.html(highlightedText).style(\"left\", event.pageX + 5 + \"px\").style(\"top\", event.pageY - 28 + \"px\");\n    }).on(\"mouseout\", d => {\n      tooltip.transition().duration(500).style(\"opacity\", 0);\n    });\n    circles.attr('r', d => d[2].toLowerCase().includes(searchQuery.toLowerCase()) ? r_big : r_small); // Adjust the dot size based on the search query\n\n    // Update existing circles\n    circles.attr('fill', (d, i) => colors[color_idx[i] % 10]).transition().ease(d3.easeLinear).duration(1500).attr('cx', d => xScale(d[0])).attr('cy', d => yScale(d[1]));\n\n    // Remove old circles\n    circles.exit().remove();\n    svg.call(lasso().on(\"start lasso end\", draw));\n    draw(defaultLasso);\n\n    /*var points=svg.selectAll('circle')\n        .data(data)\n        .enter()\n        .append('circle')\n        .attr('cx', d => xScale(d[0]))\n        .attr('cy', d => yScale(d[1]))\n        .attr('r', 4)\n        .style(\"opacity\", 0.9)\n        .attr('fill', (d,i) =>  colors[color_idx[i]%10])\n        .attr('stroke', 'black')  // Add this line for the boundary color\n        .attr('stroke-width', 0.5)  // Add this line for the boundary width\n        .on(\"mouseover\", (event, d) => {\n             svg.selectAll('circle')\n            .transition().duration(100)\n            .style(\"opacity\", 0.9) \n            .attr('stroke-width', 0.5) \n            .attr('r', 4);\n            d3.select(event.currentTarget).transition().duration(100)\n                .style(\"opacity\", 1) \n                .attr('stroke-width', 0.5)  // Add this line for the boundary width\n                .attr('r', 10);\n               tooltip.transition()\n                .duration(100)\n                .style(\"opacity\", .9);\n            tooltip.html(d[2])\n                .style(\"left\", (event.pageX + 5) + \"px\")\n                .style(\"top\", (event.pageY - 28) + \"px\");\n        })\n        .on(\"mouseout\", (d) => {\n            tooltip.transition()\n                .duration(500)\n                .style(\"opacity\", 0);\n        }).transition() // start a transition\n        .duration(2000) // 2 seconds;\n         \n        \n        if (jitter){\n            points.attr(\"cx\", function(d,i) { return xScale(d[0])+ 2*Math.random() });\n            points.attr(\"cy\", function(d,i) { return yScale(d[1])+ 2*Math.random() });\n            \n        }*/\n\n    // Bind data to text elements and add labels\n    if (labels) {\n      svg.selectAll('text.label').data(labels).enter().append('text').attr('class', 'label').attr('fill', 'black').attr('x', d => xScale(d[0])).attr('y', d => yScale(d[1])).attr('dy', '.35em').attr('text-anchor', 'middle').attr('opacity', 0).text((d, i) => d[2]) //`Cluster ${i}`\n      .attr('stroke', 'black').attr('stroke-width', '0.3px').attr('font-size', '28px').attr('font-weight', '500').transition().duration(1000).attr('opacity', 1);\n    }\n    var labeldata_all = [];\n    for (const [label, value] of Object.entries(result)) {\n      var piedata = [];\n      var i = 0;\n      for (const [key, count] of Object.entries(value)) {\n        piedata.push({\n          title: key,\n          value: count,\n          color: colors[stringToNumberMap[key]]\n        });\n        i += 1;\n      }\n      labeldata_all.push(piedata);\n    }\n    var pies = [];\n    labeldata_all.forEach((e, i) => {\n      pies.push( /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          style: {\n            position: 'relative',\n            top: '40px',\n            left: '20px'\n          },\n          children: [\"Cluster \", i]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 500,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(PieChart, {\n          data: e,\n          label: ({\n            dataEntry\n          }) => dataEntry.title,\n          labelStyle: index => ({\n            fontSize: '8px',\n            fontFamily: 'sans-serif'\n          }),\n          center: [65, 50],\n          radius: 20,\n          labelPosition: 120\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 500,\n          columnNumber: 97\n        }, this)]\n      }, void 0, true));\n    });\n    setPieCharts(pies);\n    console.log(array);\n  }, [data, labels, width, height, colorCol, jitter, searchQuery]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"text\",\n      placeholder: \"Search...\",\n      value: searchQuery,\n      onChange: e => {\n        console.log(e.target.value);\n        return setSearchQuery(e.target.value);\n      },\n      style: {\n        position: 'fixed',\n        top: '22%',\n        left: '5.2%',\n        backgroundColor: 'rgba(0, 0, 0, 0.02)',\n        boxShadow: '0px 4px 8px rgba(0, 0, 0, 0.5)',\n        // Drop shadow\n        borderRadius: '20px',\n        // Curved edges\n        fontFamily: 'Perpetua',\n        // Setting the font family\n        overflowY: 'scroll',\n        padding: '10px',\n        fontSize: '16px',\n        // Larger font size for better readability\n        border: '2px solid #007bff',\n        // Solid border with a color\n        borderRadius: '10px',\n        // Rounded corners\n        color: '#495057',\n        // Text color\n        margin: '10px 0',\n        // Margin to space out elements\n        transition: 'border-color 0.2s ease-in-out, box-shadow 0.2s ease-in-out' // Smooth transition for focus\n      },\n\n      onFocus: e => {\n        e.target.style.borderColor = '#0056b3'; // Darker border on focus\n        e.target.style.boxShadow = '0 0 0 0.2rem rgba(0, 123, 255, 0.5)'; // Glow effect on focus\n      },\n\n      onBlur: e => {\n        e.target.style.borderColor = '#007bff'; // Revert border color on blur\n        e.target.style.boxShadow = '0 4px 6px rgba(0, 0, 0, 0.5)'; // Revert box shadow on blur\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 517,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"svg\", {\n      ref: ref,\n      width: width,\n      height: height\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 546,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"legend\",\n      style: {\n        position: 'fixed',\n        top: '2%',\n        left: '86%',\n        width: '200px',\n        height: '95%',\n        backgroundColor: 'rgba(0, 0, 0, 0.02)',\n        boxShadow: '0px 4px 8px rgba(0, 0, 0, 0.5)',\n        // Drop shadow\n        borderRadius: '20px',\n        // Curved edges\n        fontFamily: 'Perpetua',\n        // Setting the font family\n        overflowY: 'scroll'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          width: '150px'\n        },\n        children: pieCharts\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 554,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(Legend, {\n        stringToNumberMap: stringToNumberMap,\n        colors: colors\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 555,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 547,\n      columnNumber: 9\n    }, this), \";\"]\n  }, void 0, true);\n}\n_s(Scatterplot, \"WPcqDbBBW/GaFEWE7Qbs4ZqlIgw=\");\n_c2 = Scatterplot;\nexport default Scatterplot;\nvar _c, _c2;\n$RefreshReg$(_c, \"Legend\");\n$RefreshReg$(_c2, \"Scatterplot\");","map":{"version":3,"names":["React","useRef","useEffect","useState","d3","PieChart","jsxDEV","_jsxDEV","Fragment","_Fragment","r_small","r_big","colors2","colors","addAlpha","color","opacity","_opacity","Math","round","min","max","slice","toString","toUpperCase","getColumn","arr","n","map","x","encodeArray","array","uniqueStrings","Set","stringToNumberMap","number","forEach","str","getEncodedArray","getPieDistribution","data","labels","distribution","i","length","label","item","Legend","style","padding","border","borderRadius","backgroundColor","boxShadow","maxWidth","fontFamily","fontSize","children","textAlign","fileName","_jsxFileName","lineNumber","columnNumber","Object","keys","index","display","alignItems","marginBottom","width","height","marginRight","_c","trackPointer","e","start","move","out","end","tracker","id","pointerId","target","point","pointer","setPointerCapture","select","on","sourceEvent","releasePointerCapture","prev","Scatterplot","props","_s","colorCol","jitter","margin","top","left","right","bottom","ref","pieCharts","setPieCharts","defaultLasso","searchQuery","setSearchQuery","setStringToNumberMap","d","svg","current","lasso","dispatch","selection","node","polygon","preventDefault","p","call","push","type","_","arguments","selectAll","remove","path","geoPath","l","append","attr","text","draw","table","document","getElementById","innerHTML","datum","coordinates","selected","circles","classed","polygonContains","xScale","yScale","TableBackgroundNormalColor","TableBackgroundMouseoverColor","ChangeBackgroundColor","row","replace","transition","dIsInSubset","RestoreBackgroundColor","tr","createElement","color_idx","addEventListener","console","log","appendChild","value","scaleLinear","domain","range","tooltip","contours","contourDensity","y","size","bandwidth","thresholds","result","enter","toLowerCase","includes","event","duration","currentTarget","highlightedText","regex","RegExp","html","pageX","pageY","ease","easeLinear","exit","labeldata_all","entries","piedata","key","count","title","pies","position","dataEntry","labelStyle","center","radius","labelPosition","placeholder","onChange","overflowY","onFocus","borderColor","onBlur","_c2","$RefreshReg$"],"sources":["/Users/Shivam/Library/CloudStorage/GoogleDrive-sraval@g.harvard.edu/My Drive/Github/embedding-modifier/app/src/plotdata.js"],"sourcesContent":["import React, { useRef, useEffect, useState } from 'react';\nimport * as d3 from 'd3';\nimport { PieChart } from 'react-minimal-pie-chart';\n\n\nconst r_small = 5\nconst r_big = 15\n\nconst colors2 = [\n    \"#9edae5\", \"#17becf\", \"#dbdb8d\", \"#bcbd22\", \"#c7c7c7\", \"#7f7f7f\", \n    \"#f7b6d2\", \"#e377c2\", \"#c49c94\", \"#8c564b\", \"#c5b0d5\", \"#9467bd\", \n    \"#ff9896\", \"#d62728\", \"#98df8a\", \"#2ca02c\", \"#ffbb78\", \"#ff7f0e\", \n    \"#aec7e8\", \"#1f77b4\"\n]\n\nconst colors = [\n    \"#d62728\", \"#bcbd22\",\"#000000\",\"#17becf\", \"#FFD700\",\"#9467bd\",\n     \"#808080\",\"#1f77b4\", \"#2ca02c\", \"#ff7f0e\", \"#7f7f7f\",\"#e377c2\"\n]\nfunction addAlpha(color, opacity) {\n    // coerce values so ti is between 0 and 1.\n    var _opacity = Math.round(Math.min(Math.max(opacity || 1, 0), 1) * 255);\n    return color.slice(0,7) + _opacity.toString(16).toUpperCase();\n}\nconst getColumn = (arr, n) => arr.map(x => x[n]);\n\nfunction encodeArray(array) {\n    // Step 1: Identify unique strings\n    const uniqueStrings = new Set(array);\n\n\n    // Step 2: Map strings to numbers\n    const stringToNumberMap = {};\n    let number = 0;\n    uniqueStrings.forEach(str => {\n        stringToNumberMap[str] = number++;\n    });\n\n    // Step 3: Generate encoded array\n    return stringToNumberMap;\n}\n\nfunction getEncodedArray(array, stringToNumberMap){\n\n    return array.map(str => stringToNumberMap[str]);\n\n}\n\nfunction getPieDistribution(data, labels) {\n    let distribution = {};\n\n    for (let i = 0; i < labels.length; i++) {\n        let label = labels[i];\n        let item = data[i];\n\n        if (!distribution[label]) {\n            distribution[label] = {};\n        }\n\n        if (!distribution[label][item]) {\n            distribution[label][item] = 0;\n        }\n\n        distribution[label][item]++;\n    }\n\n    return distribution;\n}\n\nconst Legend = ({ stringToNumberMap, colors }) => {\n  return (\n    <div style={{\n      padding: '10px',\n      border: '1px solid #ccc',\n      borderRadius: '5px',\n      backgroundColor: '#fff',\n      boxShadow: '0 2px 4px rgba(0,0,0,0.1)',\n      maxWidth: '200px',\n      fontFamily: 'Arial, sans-serif',\n      fontSize: '14px'\n    }}>\n      <h3 style={{ textAlign: 'center' }}>Legend</h3>\n      {Object.keys(stringToNumberMap).map((label, index) => (\n        <div key={index} style={{\n          display: 'flex',\n          alignItems: 'center',\n          marginBottom: '4px',\n        }}>\n          <span style={{\n            display: 'inline-block',\n            width: '20px',\n            height: '20px',\n            borderRadius: '50%',\n            backgroundColor: colors[stringToNumberMap[label] % colors.length],\n            marginRight: '10px',\n          }}></span>\n          <span>{label}</span>\n        </div>\n      ))}\n    </div>\n  );\n};\n\nfunction trackPointer(e, { start, move, out, end }) {\n    const tracker = {},\n      id = (tracker.id = e.pointerId),\n      target = e.target;\n    tracker.point = d3.pointer(e, target);\n    target.setPointerCapture(id);\n  \n    d3.select(target)\n      .on(`pointerup.${id} pointercancel.${id} lostpointercapture.${id}`, (e) => {\n        if (e.pointerId !== id) return;\n        tracker.sourceEvent = e;\n        d3.select(target).on(`.${id}`, null);\n        target.releasePointerCapture(id);\n        end && end(tracker);\n      })\n      .on(`pointermove.${id}`, (e) => {\n        if (e.pointerId !== id) return;\n        tracker.sourceEvent = e;\n        tracker.prev = tracker.point;\n        tracker.point = d3.pointer(e, target);\n        move && move(tracker);\n      })\n      .on(`pointerout.${id}`, (e) => {\n        if (e.pointerId !== id) return;\n        tracker.sourceEvent = e;\n        tracker.point = null;\n        out && out(tracker);\n      });\n  \n    start && start(tracker);\n  }\n\n\n\n\n\nfunction Scatterplot(props) {\n  var { width, height, data , labels, colorCol, jitter} = props;\n  const margin = {top:100, left:120, right:80, bottom:100}\n  const ref = useRef();\n  const [pieCharts, setPieCharts] = useState([])\n  const defaultLasso = [[0,0]]\n\n  const [searchQuery, setSearchQuery] = useState('this is a test');\n  const [stringToNumberMap, setStringToNumberMap] = useState({'0':'none'});\n\n\n  useEffect(() => {\n    data.forEach((d,i)=>{d.id = i})\n    const svg = d3.select(ref.current);\n\n\n    function lasso() {\n        const dispatch = d3.dispatch(\"start\", \"lasso\", \"end\");\n        const lasso = function(selection) {\n          const node = selection.node();\n          const polygon = [];\n      \n          selection\n            .on(\"touchmove\", e => e.preventDefault()) // prevent scrolling\n            .on(\"pointerdown\", e => {\n              trackPointer(e, {\n                start: p => {\n                  polygon.length = 0;\n                  dispatch.call(\"start\", node, polygon);\n                },\n                move: p => {\n                  polygon.push(p.point);\n                  dispatch.call(\"lasso\", node, polygon);\n                },\n                end: p => {\n                  dispatch.call(\"end\", node, polygon);\n                }\n              });\n            });\n        };\n        lasso.on = function(type, _) {\n          return _ ? (dispatch.on(...arguments), lasso) : dispatch.on(...arguments);\n        };\n      \n        return lasso;\n      }\n\n    //svg.selectAll('*').remove()\n    svg.selectAll('text.label').remove()\n    svg.selectAll(\"path\").remove()\n    d3.select(\"#selectioncontent\").selectAll('*').remove()\n\n    \n    const path = d3.geoPath()\n    const l = svg.append(\"path\").attr(\"class\", \"lasso\")\n\n    svg.append(\"defs\").append(\"style\").text(`\n    .selected {r: 2.5; fill: red}\n    .lasso { fill-rule: evenodd; fill-opacity: 0.1; stroke-width: 1.5; stroke: #000; z-index: 0;}\n  `);\n\n\n    function draw(polygon) {\n        //d3.select(\"#selectioncontent\").selectAll('*').remove()\n\n        // selectioncontent\n       // const selectioncontent = d3.select(\"#selectioncontent\").append(\"div\")\n        //var content = '<table>'\n\n        let table = document.getElementById(\"myTable\");\n        table.innerHTML = \"\";\n\n        l.datum({\n          type: \"LineString\",\n          coordinates: polygon\n        }).attr(\"d\", path).style('z-index',-10);\n    \n        const selected = [];\n    \n        // note: d3.polygonContains uses the even-odd rule\n        // which is reflected in the CSS for the lasso shape\n        circles.classed(\n          \"selected\",\n          polygon.length > 2\n            ? d => {d3.polygonContains(polygon, [xScale(d[0]),yScale(d[1])]) && selected.push(d) }//&& (content += \" <tr><td>\"+d[2] + \"</td></tr>\" )}\n            : false\n        );\n        //content += '</table>'\n\n        /*for (const [key, idx] of Object.entries(stringToNumberMap)){\n            console.log(key,\"<font color=\\\"red\\\">\"+key+\"</font>\")\n            content = content.replaceAll(key,\"<font color=\\\"\"+colors[idx]+\"\\\">\"+key+\"</font>\")\n        }*/\n\n        var TableBackgroundNormalColor = \"#ffffff\";\n        var TableBackgroundMouseoverColor = \"#b8b6b6\";\n\n        // These two functions need no customization.\n        function ChangeBackgroundColor(row,id) { \n            row.style.backgroundColor =  row.style.backgroundColor.replace(/[^,]+(?=\\))/, 0.8);\n\n            row.style.border= '1px solid black !important'\n\n            svg.selectAll('circle').transition(100).attr(\"r\", function(d) {\n                var dIsInSubset = d.id == id;\n                return dIsInSubset ? r_big : r_small\n              })\n        \n        }\n        function RestoreBackgroundColor(row) { \n            row.style.backgroundColor =  row.style.backgroundColor.replace(/[^,]+(?=\\))/, 0.4);\n            //row.style.backgroundColor = TableBackgroundNormalColor; \n            svg.selectAll('circle').transition(100).attr(\"r\", r_small)\n        }\n\n        selected.forEach(d=>{\n            let tr = document.createElement(\"tr\");\n            tr.innerHTML =`<td>${d[2]}</td>`;\n            tr.style.backgroundColor = addAlpha(colors[color_idx[d.id]],0.4)\n\n            //tr.addEventListener('mouseover', () => console.log(d));\n            tr.addEventListener('mouseover', () => {console.log(d);ChangeBackgroundColor(tr,d.id)});\n            tr.addEventListener('mouseout', () => {console.log(d);RestoreBackgroundColor(tr)});\n\n            table.appendChild(tr);\n\n        })\n        svg.value = { polygon, selected };\n\n        //selectioncontent.html(content)\n        //selectioncontent.addEventListener('mouseover', () => console.log(datum));\n\n\n\n      }\n    \n\n    \n\n    \n\n    // Set scales for the scatterplot\n    const xScale = d3.scaleLinear()\n      .domain([d3.min(data, d => d[0]), d3.max(data, d => d[0])])\n      .range([margin.left, width-margin.right]);\n\n    const yScale = d3.scaleLinear()\n      .domain([d3.min(data, d => d[1]), d3.max(data, d => d[1])])\n      .range([height-margin.bottom, margin.top]);\n\n\n    // Tooltips\n    const tooltip = d3.select(\"body\").append(\"div\")\n        .attr(\"class\", \"tooltip\")\n        .style(\"opacity\", 0)\n        .style(\"background-color\", \"white\")\n        .style(\"border\", \"solid\")\n        .style(\"border-width\", \"2px\")\n        .style(\"border-radius\", \"5px\")\n        .style(\"padding\", \"5px\")\n        .style(\"margin-right\", \"50px\")\n        .style(\"position\", \"absolute\");\n\n  console.log(data)\n    // Bind data to circles and add tooltips\n    //console.log(labels)\n    // Compute the density contours.\n    const contours = d3.contourDensity()\n    .x(d => xScale(d[0]))\n    .y(d => yScale(d[1]))\n    .size([width, height])\n    .bandwidth(40)\n    .thresholds(3)\n    (data);\n\n\n\n    //console.log(contours)\n    \n\n    // Append the contours.\n    /*var contourPaths = svg.selectAll('contours').attr(\"stroke-linejoin\", \"round\")\n        .attr(\"stroke\", 'black')\n        .data(contours)\n        .join(\"path\")\n        .style(\"opacity\", 0) \n        .attr(\"fill\", (d, i) => 'gray')\n        .attr(\"stroke-width\", (d, i) => i % 5 ? 0.25 : 1)\n        //.attr(\"stroke\", 'red')\n        .style(\"z-index\", -1)\n        .attr(\"d\", d3.geoPath());\n\n    contourPaths.transition().duration(2500).style(\"opacity\", (d, i) => i % 5 ? 0 : 0.2)*/ \n\n    //SetcolorCol\n    if (colorCol!=-1){\n        var array = getColumn(data,colorCol)\n        setStringToNumberMap(encodeArray(array)) ;\n\n\n\n    }else{\n        var array = getColumn(data,3)\n        setStringToNumberMap(encodeArray(getColumn(data,3)))\n    }\n\n\n\n    var color_idx = getEncodedArray(array, stringToNumberMap)\n\n    let result = getPieDistribution(getColumn(data,colorCol), getColumn(data,3));\n\n    console.log(colorCol,stringToNumberMap)\n\n     // Bind data to circles\n     const circles = svg.selectAll('circle').data(data);\n\n     // Enter new circles\n     circles.enter().append('circle')\n         .attr('cx', d => xScale(d[0]))\n         .attr('cy', d => yScale(d[1]))\n         .attr('r', d => d[2].toLowerCase().includes(searchQuery.toLowerCase()) ? r_big : r_small)\n         .style(\"opacity\", 0.9)\n        .attr('fill', (d,i) =>  colors[color_idx[i]%10])\n        .attr('stroke', 'black')  // Add this line for the boundary color\n        .attr('stroke-width', 0.5)  // Add this line for the boundary width\n        .style(\"z-index\", 2)\n        .on(\"mouseover\", (event, d) => {\n\n            svg.selectAll('circle')\n            .transition().duration(100)\n            .style(\"opacity\", 0.9) \n            .attr('stroke-width', 0.5) \n            //.attr('r', r_small);\n            d3.select(event.currentTarget).transition().duration(100)\n                .style(\"opacity\", 1) \n                .attr('stroke-width', 4)  // Add this line for the boundary width\n                //.attr('r', r_small);\n\n            let highlightedText = d[2];\n            if (searchQuery) {\n                  const regex = new RegExp(`(${searchQuery})`, 'gi');\n                  highlightedText = highlightedText.replace(regex, \"<span style='background-color: yellow;'>$1</span>\");\n                }\n\n            tooltip.transition()\n                .duration(100)\n                .style(\"opacity\", .9);\n            tooltip.html(highlightedText)\n                .style(\"left\", (event.pageX + 5) + \"px\")\n                .style(\"top\", (event.pageY - 28) + \"px\");\n        })\n        .on(\"mouseout\", (d) => {\n            tooltip.transition()\n                .duration(500)\n                .style(\"opacity\", 0);\n        })\n\n      circles.attr('r', d => d[2].toLowerCase().includes(searchQuery.toLowerCase()) ? r_big : r_small); // Adjust the dot size based on the search query\n\n     \n     // Update existing circles\n     circles.attr('fill', (d,i) =>  colors[color_idx[i]%10]).transition().ease(d3.easeLinear).duration(1500)\n         .attr('cx', d => xScale(d[0]))\n         .attr('cy', d => yScale(d[1]))\n\n      \n     // Remove old circles\n     circles.exit().remove();\n\n     svg.call(lasso().on(\"start lasso end\", draw));\n     draw(defaultLasso);\n    \n    /*var points=svg.selectAll('circle')\n        .data(data)\n        .enter()\n        .append('circle')\n        .attr('cx', d => xScale(d[0]))\n        .attr('cy', d => yScale(d[1]))\n        .attr('r', 4)\n        .style(\"opacity\", 0.9)\n        .attr('fill', (d,i) =>  colors[color_idx[i]%10])\n        .attr('stroke', 'black')  // Add this line for the boundary color\n        .attr('stroke-width', 0.5)  // Add this line for the boundary width\n        .on(\"mouseover\", (event, d) => {\n\n            svg.selectAll('circle')\n            .transition().duration(100)\n            .style(\"opacity\", 0.9) \n            .attr('stroke-width', 0.5) \n            .attr('r', 4);\n            d3.select(event.currentTarget).transition().duration(100)\n                .style(\"opacity\", 1) \n                .attr('stroke-width', 0.5)  // Add this line for the boundary width\n                .attr('r', 10);\n\n\n\n            tooltip.transition()\n                .duration(100)\n                .style(\"opacity\", .9);\n            tooltip.html(d[2])\n                .style(\"left\", (event.pageX + 5) + \"px\")\n                .style(\"top\", (event.pageY - 28) + \"px\");\n        })\n        .on(\"mouseout\", (d) => {\n            tooltip.transition()\n                .duration(500)\n                .style(\"opacity\", 0);\n        }).transition() // start a transition\n        .duration(2000) // 2 seconds;\n\n        \n        \n        if (jitter){\n            points.attr(\"cx\", function(d,i) { return xScale(d[0])+ 2*Math.random() });\n            points.attr(\"cy\", function(d,i) { return yScale(d[1])+ 2*Math.random() });\n            \n        }*/\n\n\n\n    // Bind data to text elements and add labels\nif(labels){\n  svg.selectAll('text.label')\n  .data(labels)\n  .enter()\n  .append('text')\n  .attr('class', 'label')\n  .attr('fill', 'black')  \n  .attr('x', d => xScale(d[0])) \n  .attr('y', d => yScale(d[1]))\n  .attr('dy', '.35em')  \n  .attr('text-anchor', 'middle')\n  .attr('opacity', 0)\n  .text((d,i) => d[2])//`Cluster ${i}`\n  .attr('stroke', 'black')  \n  .attr('stroke-width', '0.3px') \n  .attr('font-size', '28px')\n  .attr('font-weight', '500').transition().duration(1000).attr('opacity', 1)\n  ;\n}\n    \n        var labeldata_all = []\n        for (const [label, value] of Object.entries(result)) {\n            var piedata = []\n            var i =0\n            for (const [key, count] of Object.entries(value)){\n                \n                piedata.push({ title: key, value: count, color: colors[stringToNumberMap[key]] })\n                i+=1\n            }\n            labeldata_all.push(piedata)\n          }\n\n\n   \n        \n        var pies = []\n        labeldata_all.forEach((e,i)=>{\n            pies.push(<><p style={{position:'relative', top:'40px',left:'20px'}}>Cluster {i}</p><PieChart data={e} label={({ dataEntry }) => dataEntry.title}\n        labelStyle={(index) => ({\n            fontSize: '8px',\n            fontFamily: 'sans-serif',\n          })}\n          center={[65,50]}\n          radius={20}\n          labelPosition={120}/></>)\n        })\n\n        setPieCharts(pies)\n        console.log(array)\n\n  }, [data, labels, width, height, colorCol, jitter,searchQuery]);\n\n  return (\n    <>\n        <input\n      type=\"text\"\n      placeholder=\"Search...\"\n      value={searchQuery}\n      onChange={(e) => {console.log(e.target.value);return setSearchQuery(e.target.value)}}\n      style={{ position: 'fixed', top: '22%', left: '5.2%', backgroundColor: 'rgba(0, 0, 0, 0.02)',\n                 boxShadow: '0px 4px 8px rgba(0, 0, 0, 0.5)',  // Drop shadow\n                borderRadius: '20px' ,                         // Curved edges\n                fontFamily: 'Perpetua',  // Setting the font family\n                overflowY: 'scroll',\n                padding: '10px',\n                fontSize: '16px', // Larger font size for better readability\n                border: '2px solid #007bff', // Solid border with a color\n                borderRadius: '10px', // Rounded corners\n                color: '#495057', // Text color\n                margin: '10px 0', // Margin to space out elements\n                transition: 'border-color 0.2s ease-in-out, box-shadow 0.2s ease-in-out', // Smooth transition for focus\n                \n                }}\n\n      onFocus={(e) => {\n                  e.target.style.borderColor = '#0056b3'; // Darker border on focus\n                  e.target.style.boxShadow = '0 0 0 0.2rem rgba(0, 123, 255, 0.5)'; // Glow effect on focus\n                }}\n      onBlur={(e) => {\n                  e.target.style.borderColor = '#007bff'; // Revert border color on blur\n                  e.target.style.boxShadow = '0 4px 6px rgba(0, 0, 0, 0.5)'; // Revert box shadow on blur\n                }}\n    />\n        <svg ref={ref} width={width} height={height}></svg>\n        <div id = 'legend' style={{ position: 'fixed', top: '2%', left: '86%', width: '200px',height:'95%', backgroundColor: 'rgba(0, 0, 0, 0.02)',\n                 boxShadow: '0px 4px 8px rgba(0, 0, 0, 0.5)',  // Drop shadow\n                borderRadius: '20px' ,                         // Curved edges\n                fontFamily: 'Perpetua',  // Setting the font family\n                overflowY: 'scroll'\n                }}>\n        \n            <div style={{ width:'150px',}}>{pieCharts}</div>\n            <Legend stringToNumberMap={stringToNumberMap} colors={colors} />\n\n            \n            </div>;\n    </>\n  )\n}\n\nexport default Scatterplot;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}